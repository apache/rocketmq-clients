name: CI
on: [push, pull_request]
jobs:
  cpp_build:
    name: CPP build
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup Bazel
        run: |
          sudo apt-get -qq install npm
          sudo npm install -g @bazel/bazelisk
      - name: Use Bazel
        if: matrix.os != 'windows'
        working-directory: ./cpp
        run: bazel -h
      - name: Compile All Targets
        working-directory: ./cpp
        run: bazel build //...
  c_sharp_build:
    name: C# build
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 
        uses: actions/checkout@v2
      - name: Setup dotnet
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: | 
            5.0.x
            6.0.x
      - name: Build artifacts
        working-directory: ./csharp
        run: |
          dotnet --version
          dotnet build
  java_build:
    name: Java build
    runs-on: ubuntu-latest
    steps:
    - name: Checkout
      uses: actions/checkout@v2
    - name: Set up JDK 11
      uses: actions/setup-java@v2
      with:
        java-version: '11'
        distribution: 'adopt'
        cache: maven
    - name: Build with Maven
      working-directory: ./java
      run: mvn -B package --file pom.xml

